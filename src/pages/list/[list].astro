---
import VueLayout from "@/layouts/VueLayout.astro";
import WishList from "./_WishList.vue";
import { createAdminClient } from "@/server/appwrite";
import { APPWRITE_DB, APPWRITE_LIST_COLLECTION } from "astro:env/client";
import { Permission, Role } from "node-appwrite";

import { load as loadList } from "@/utils/list.js";

const { user } = Astro.locals;
const { list: listId } = Astro.params;

const params = new URLSearchParams(Astro.url.search);
const { quickCreateURL } = Object.fromEntries(params.entries());

// const client = createAdminClient();

// let list;
// let loadedAsAuthor = false;
// let communityItems = [];
// let fulfillments = [];
// const avoidSpoilersDialogShown = false;

// try {
//     const listResponse = await loadList({
//         tablesDB: client.tablesDB,
//         listId,
//         user
//     })
//     list = listResponse.list;
//     loadedAsAuthor = listResponse.loadedAsAuthor;
//     fulfillments = listResponse.fulfillments;
// } catch (error) {
//     if (error?.code === 404) {
//         return Astro.rewrite("/404");
//     }
//     console.log({ error });
//     throw error;
// }
// listData={{ list, loadedAsAuthor, fulfillments, communityItems, avoidSpoilersDialogShown }}

export const prerender = false;
---

<VueLayout user={user}>
    <WishList
        client:only="vue"
        listId={listId}
        quickCreateURLParam={quickCreateURL}
    />
</VueLayout>

